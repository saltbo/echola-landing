---
/** biome-ignore-all lint/correctness/noUnusedImports: Breadcrumbs component is used in template below */
/** biome-ignore-all lint/correctness/noUnusedVariables: Props interface extends imported type */

import Breadcrumbs from "@ui/navigation/Breadcrumbs";
import TableOfContents from "@ui/navigation/TableOfContents";
import AnimatedContent from "@ui/shared/AnimatedContent";
import AnimatedSidebar from "@ui/shared/AnimatedSidebar";
import { parseMarkdown } from "@utils/parseMarkdown";

interface Props {
	breadcrumbLabel: string;
	content: string;
}

const { breadcrumbLabel, content } = Astro.props;
const htmlContent = await parseMarkdown(content);
---

<main class="pt-8 md:pt-12 px-4 md:px-6">
	<div class="max-w-[1500px] mx-auto">
		<Breadcrumbs items={[{ label: breadcrumbLabel }]} client:load />
		<div class="flex gap-16">
			<AnimatedContent client:load>
				<article>
					<div class="prose">
						<Fragment set:html={htmlContent} />
					</div>
				</article>
			</AnimatedContent>
			<AnimatedSidebar client:load>
				<TableOfContents content={content} client:load />
			</AnimatedSidebar>
		</div>
	</div>
</main>

<style is:global>
	.prose { 
		max-width: 1000px;
		line-height: 1.7;
		color: #374151;
	}
	.dark .prose { color: #d1d5db; }
	
	.prose h1, .prose h2, .prose h3 { 
		scroll-margin-top: 6rem;
		color: #111827;
	}
	.dark .prose h1, .dark .prose h2, .dark .prose h3 { color: #f9fafb; }

	.prose h1 {
		font-size: 2.5rem;
		font-weight: 800;
		margin: 0 0 2rem;
		letter-spacing: -0.025em;
	}

	.prose h2 {
		font-size: 1.875rem;
		font-weight: 700;
		margin: 3.5rem 0 1.25rem;
		padding-bottom: 0.5rem;
		border-bottom: 1px solid rgba(156, 163, 175, 0.2);
	}
	.dark .prose h2 { border-color: rgba(255, 255, 255, 0.1); }

	.prose h3 { 
		font-size: 1.5rem;
		font-weight: 600;
		margin: 2.5rem 0 1rem;
	}

	.prose p { margin: 1.5rem 0; font-size: 1.0625rem; }
	.prose strong { font-weight: 600; color: inherit; }

	.prose ul, .prose ol { margin: 1.5rem 0; padding-left: 1.75rem; }
	.prose li { margin: 0.75rem 0; padding-left: 0.5rem; }
	.prose li::marker { color: #6b7280; }
	.dark .prose li::marker { color: #9ca3af; }

	.prose a { 
		color: #2563eb;
		text-decoration: underline;
		text-decoration-color: rgba(37, 99, 235, 0.3);
		text-underline-offset: 3px;
		transition: all 0.2s;
	}
	.prose a:hover { color: #1d4ed8; text-decoration-color: currentColor; }
	.dark .prose a { color: #60a5fa; }
	.dark .prose a:hover { color: #93c5fd; }

	.prose code {
		background: rgba(156, 163, 175, 0.1);
		border: 1px solid rgba(156, 163, 175, 0.2);
		border-radius: 0.375rem;
		padding: 0.2em 0.4em;
		font-size: 0.875em;
		color: #dc2626;
		font-family: ui-monospace, monospace;
	}
	.dark .prose code { background: rgba(255, 255, 255, 0.05); border-color: rgba(255, 255, 255, 0.1); color: #fca5a5; }

	.prose pre {
		background: #1e293b;
		border: 1px solid rgba(148, 163, 184, 0.2);
		border-radius: 0.75rem;
		padding: 1.25rem;
		margin: 2rem 0;
		overflow-x: auto;
	}
	.dark .prose pre { background: rgba(255, 255, 255, 0.03); border-color: rgba(255, 255, 255, 0.1); }
	.prose pre code { background: transparent; border: none; padding: 0; color: #e2e8f0; }

	.prose blockquote { border-left: 4px solid #3b82f6; padding-left: 1.25rem; margin: 2rem 0; font-style: italic; }
	.dark .prose blockquote { border-color: #60a5fa; }

	.prose table { width: 100%; margin: 2rem 0; border-collapse: collapse; }
	.prose thead { border-bottom: 2px solid #e5e7eb; }
	.dark .prose thead { border-color: rgba(255, 255, 255, 0.1); }
	.prose th { padding: 0.75rem 1rem; text-align: left; font-weight: 600; }
	.prose td { padding: 0.75rem 1rem; border-bottom: 1px solid #f3f4f6; }
	.dark .prose td { border-color: rgba(255, 255, 255, 0.05); }

	.prose hr { margin: 3rem 0; border: 0; border-top: 1px solid #e5e7eb; }
	.dark .prose hr { border-color: rgba(255, 255, 255, 0.1); }

	@media (max-width: 768px) {
		.prose h1 { font-size: 2rem; margin-bottom: 1.5rem; }
		.prose h2 { font-size: 1.5rem; margin-top: 2.5rem; }
		.prose h3 { font-size: 1.25rem; margin-top: 2rem; }
	}
</style>
